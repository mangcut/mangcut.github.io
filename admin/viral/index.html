---
layout: default
categories: work
title: Admin - Social Network Monitoring
description: Măng cụt viết với mục tiêu thay đổi nhận thức của mọi người qua đó làm cho thế giới tốt đẹp hơn.
image: http://www.gravatar.com/avatar/7a64ed9293c645e5857255e8f2320a8d?s=292
comment: false
---
<style>
#hor-minimalist-b {
  border-collapse: collapse;
  text-align: left;
  border-spacing: 0;
  width: 100%;
  border: 1px solid #bbb;
}
#hor-minimalist-b .hilight{
	width: 130px;
}
#hor-minimalist-b th {
  font-weight: bold;
  border: 1px solid #bbb;
  padding: 5px 10px;
  background-color: whitesmoke;
}
#hor-minimalist-b td .hilight-wrap{
  position: relative;
  width: 100px;
  border: #ccc 1px solid;
}
#hor-minimalist-b td .hilight-bar{
  padding: 0
  margin: 0;
  border: 0;
  position: absolute;
  top: 0; left: 0; bottom: 0;
}
#hor-minimalist-b td .hilight-num{
  padding: 3px 5px;
  margin: 0;
  border: 0;
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background-color: transparent;
  text-align: right;
  font-size: 0.8em;
  color: black;
}
  
#hor-minimalist-b td {
  border: 1px solid #bbb;
  padding: 5px 10px
}
</style>
<h3 style="padding-top:13px;padding-bottom: 10px">Facebook Popularity Check</a></h3>
<p>
<table id="hor-minimalist-b">
<thead>
	<th>#</th>
	<th>URL</th>
	<th class="hilight">Popularity</th>
	<th>Likes</th>
	<th>Comments</th>
	<th>Shares</th>
	<th>SUM</th>
</thead>
<tbody id="virality_results">
</tbody>
</table>
<ol id="virality_results">
</ol>
</p>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script type="text/javascript">
(function(){

// Format Number functions
function formatNumber(yourNumber) {
    //Seperates the components of the number
    var components = yourNumber.toString().split(".");
    //Comma-fies the first part
    components[0] = components[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    //Combines the two sections
    return components.join(".");
}

// Get FB data
function loadData(params) {
	var tags = [];
	$.getJSON('http://api.facebook.com/restserver.php', params)
		.always(function(data) {
			console.log(data.status + ": " + data.statusText);
			var items = $(data.responseText);
			items.find("link_stat").each(function(index){
				var $t = $(this);
				var item = {
					normalized_url: $t.find("normalized_url").text(),
					share_count: $t.find("share_count").text(),
					like_count: $t.find("like_count").text(),
					comment_count: $t.find("comment_count").text(),
					total_count: $t.find("total_count").text()
				}
	
				var virality = item.share_count * 1000 + item.comment_count * 20 + item.like_count;
				if (virality > 1) {
					virality = Math.round(Math.sqrt(Math.sqrt(virality)) / 10);
					if (virality > 100) virality = 100;
				} else {
					virality = 0;
				}
				var color = "rgb(" + Math.floor(virality * 2.55) + ", 255, 0)";
				
				var row = "<tr>" +
					"<td>" + (index + 1) + "</td>" +
					"<td>" + item.normalized_url.replace(/^.*\/\/[^\/]+/, '').replace("/blog/","") + "</td>" +
					"<td class='hilight'>" +
						"<div class='hilight-wrap'>&nbsp;" +
							"<div class='hilight-bar' style='width:" + virality + "px;background-color:" + color + "'>&nbsp;</div>" +
							"<div class='hilight-num'>" + virality + "%</div>" +
						"</div>" + "</td>" +
					"<td>" + formatNumber(item.like_count) + "</td>" +
					"<td>" + formatNumber(item.comment_count) + "</td>" +
					"<td>" + formatNumber(item.share_count) + "</td>" +
					"<td>" + formatNumber(item.total_count) + "</td>" +
					"</tr>";
				$("#virality_results").append(row);
			});
		});
	
	$("#virality_results").append(tags);
}

var postUrls = [];
$.ajax("/atom/all.xml").done(function(data){
	console.log(data);
	$(data).find("entry link").each(function() {
		postUrls.push($(this).attr("href"));
	})
	var params = {
		method: "links.getStats",
		urls: postUrls
	};	
	loadData(params);
});

})();
</script>